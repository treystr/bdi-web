---
import Button from '@components/ui/Button.astro';

interface Initiative {
    id: string;
    data: {
        title: string;
        shortDescription: string;
        goalAmount: number;
        currentAmount: number;
        startDate: Date;
        targetDate?: Date;
        status: 'active' | 'completed' | 'planned';
        featured: boolean;
    };
}

interface Props {
    initiative: Initiative;
}

const { initiative } = Astro.props;
const { data } = initiative;

// Calculate progress percentage
const progressPercent = data.goalAmount > 0 
    ? Math.round((data.currentAmount / data.goalAmount) * 100)
    : 0;

// Format target date
const targetDate = data.targetDate 
    ? new Intl.DateTimeFormat('en-US', {
        year: 'numeric',
        month: 'long',
    }).format(new Date(data.targetDate))
    : null;
---

<div class="featured-initiative-card bg-white/95 backdrop-blur-sm rounded-xl p-6 md:p-8 shadow-2xl border border-white/20 max-w-2xl mx-auto transform transition-all duration-300" data-aos="fade-up" data-aos-delay="300">
    <!-- Featured Badge -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2">
        <span class="inline-block px-3 py-1 text-xs font-semibold bg-accent text-white rounded-full w-fit">
            Featured Initiative
        </span>
        {targetDate && (
            <span class="text-sm text-body-base/70 font-medium">
                Target: {targetDate}
            </span>
        )}
    </div>
    
    <!-- Title -->
    <h3 class="text-xl sm:text-2xl md:text-3xl font-bold text-body-base mb-4 leading-tight">
        {data.title}
    </h3>
    
    <!-- Description -->
    <p class="text-body-base/80 text-base sm:text-lg leading-relaxed mb-6">
        {data.shortDescription}
    </p>
    
    <!-- Progress Bar (if applicable) -->
    {data.goalAmount > 0 && (
        <div class="mb-6">
            <div class="flex justify-between text-sm mb-2">
                <span class="font-semibold text-body-base">Funding Progress</span>
                <span class="text-body-base/70">
                    ${data.currentAmount.toLocaleString()} / ${data.goalAmount.toLocaleString()}
                </span>
            </div>
            <div class="w-full bg-body-base/10 rounded-full h-3 overflow-hidden">
                <div 
                    class="bg-accent h-full rounded-full transition-all duration-500"
                    style={`width: ${progressPercent}%`}
                />
            </div>
            <p class="text-xs text-body-base/60 mt-1">
                {progressPercent}% funded
            </p>
        </div>
    )}
    
    <!-- CTA Buttons -->
    <div class="flex flex-col sm:flex-row gap-3 sm:gap-4">
        <Button
            href={`/initiatives/${initiative.id}`}
            variant="primary"
        >
            Learn More
        </Button>
        <Button
            href="/donate"
            variant="secondary"
        >
            Support This Initiative
        </Button>
    </div>
</div>

<style>
    .featured-initiative-card {
        /* Ensure good contrast and readability over hero backgrounds */
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
    }
    
    /* Add subtle animation on hover */
    .featured-initiative-card:hover {
        transform: translateY(-2px);
        transition: transform 0.3s ease;
    }
</style>
