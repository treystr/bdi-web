---
import { getSocialLinksByLocation, type SocialLocation, type SocialIconType } from '@data/config';
import { Github, Linkedin, Mail, Instagram, Feather, Calendar } from 'lucide-astro';
import X from '@components/icons/X.astro';
import Tiktok from '@components/icons/Tiktok.astro';

interface Props {
  iconSize?: number;
  gap?: string;
  colorClass?: string;
  hoverColorClass?: string;
  location?: SocialLocation;
  visibleIcons?: SocialIconType[]; // Backward compatibility - overrides location if provided
}

const { 
  iconSize = 20, 
  gap = 'gap-6',
  colorClass = 'text-body-dark',
  hoverColorClass = 'hover:text-white',
  location = 'all',
  visibleIcons
} = Astro.props;

const iconProps = { 
  size: iconSize, 
  class: `${colorClass} ${hoverColorClass} transition-colors` 
};

// Filter social links based on location or visibleIcons prop (visibleIcons takes precedence for backward compatibility)
const displayedLinks = visibleIcons 
  ? getSocialLinksByLocation('all').filter(link => visibleIcons.includes(link.icon))
  : getSocialLinksByLocation(location);
---

<nav aria-label="Social media links">
  <ul class={`flex justify-center items-center ${gap}`}>
    {displayedLinks.map(link => (
      <li>
        <a 
          href={link.url} 
          target="_blank" 
          rel="noopener noreferrer"
          aria-label={`Follow us on ${link.icon}`}
          class={`inline-flex items-center justify-center ${colorClass} ${hoverColorClass} transition-colors`}
        >
          {link.icon === 'x' && <X size={iconSize} class={`${colorClass} ${hoverColorClass} transition-colors`} />}
          {link.icon === 'instagram' && <Instagram {...iconProps} />}
          {link.icon === 'github' && <Github {...iconProps} />}
          {link.icon === 'linkedin' && <Linkedin {...iconProps} />}
          {link.icon === 'mail' && <Mail {...iconProps} />}
          {link.icon === 'nostr' && <Feather {...iconProps} />}
          {link.icon === 'tiktok' && <Tiktok size={iconSize} class={`${colorClass} ${hoverColorClass} transition-colors`} />}
          {link.icon === 'calendar' && <Calendar {...iconProps} />}
        </a>
      </li>
    ))}
  </ul>
</nav>

