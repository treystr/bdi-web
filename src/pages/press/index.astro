---
import Layout from '@layouts/Layout.astro';
import PageHeader from '@components/sections/PageHeader.astro';
import BlogPost from '@components/blog/BlogPost.astro';
import { getCollection } from 'astro:content';
import { getCategoryBySlug } from '@data/categories';

const seoTitle = "Press";
const seoDescription = "Press releases and publications from the Bitcoin District Initiative.";

const pageHeaderContent = {
    title: "Press",
    description: "Press releases and publications from the Bitcoin District Initiative."
};

// Get all published blog posts
const allPosts = await getCollection('blog', ({ data }) => {
    return import.meta.env.DEV || data.publish !== false;
});

// Get press category
const pressCategory = getCategoryBySlug('press');

// Filter posts by Press category
const pressPosts = allPosts
    .filter(post => post.data.categories?.includes('Press'))
    .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());

---

<Layout title={seoTitle} description={seoDescription}>
    <PageHeader 
        title={pageHeaderContent.title} 
        description={pageHeaderContent.description} 
        background="base" 
    />

    <section class="py-xsmall bg-background">
        <div class="site-container--content mx-auto px-4">
            {pressPosts.length > 0 ? (
                <>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                        {pressPosts.map((post, index) => (
                            <BlogPost
                                title={post.data.title}
                                excerpt={post.data.excerpt}
                                featuredImage={post.data.featuredImage || ''}
                                publishDate={post.data.publishDate}
                                categories={post.data.categories || []}
                                slug={post.id}
                                index={index}
                            />
                        ))}
                    </div>
                    <div class="text-center" data-aos="fade-up">
                        <a 
                            href="/category/press" 
                            class="btn btn-secondary inline-flex items-center gap-2"
                        >
                            View All Press Releases
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </a>
                    </div>
                </>
            ) : (
                <p class="text-body-base/60 italic">No press releases available yet. Check back soon!</p>
            )}
        </div>
    </section>
</Layout>

