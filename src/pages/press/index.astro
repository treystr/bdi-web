---
import Layout from '@layouts/Layout.astro';
import PageHeader from '@components/sections/PageHeader.astro';
import PressPost from '@components/press/PressPost.astro';
import { getCollection } from 'astro:content';

const seoTitle = "Press";
const seoDescription = "Press releases and publications from the Bitcoin District Initiative.";

const pageHeaderContent = {
    title: "Press",
    description: "Press releases and publications from the Bitcoin District Initiative."
};

// Get all published press posts
const pressPosts = await getCollection('press', ({ data }) => {
    return import.meta.env.DEV || data.publish !== false;
});

// Sort posts by date (newest first)
const sortedPressPosts = pressPosts.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());

---

<Layout title={seoTitle} description={seoDescription}>
    <PageHeader 
        title={pageHeaderContent.title} 
        description={pageHeaderContent.description} 
        background="base" 
    />

    <section class="py-xsmall bg-background">
        <div class="site-container--content mx-auto px-4">
            {sortedPressPosts.length > 0 ? (
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {sortedPressPosts.map((post, index) => (
                        <PressPost
                            title={post.data.title}
                            excerpt={post.data.excerpt}
                            featuredImage={post.data.featuredImage}
                            publishDate={post.data.publishDate}
                            slug={post.id}
                            index={index}
                        />
                    ))}
                </div>
            ) : (
                <p class="text-body-base/60 italic">No press releases available yet. Check back soon!</p>
            )}
        </div>
    </section>
</Layout>

