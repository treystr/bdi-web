---
import { getCollection, render } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import FullScreenHero from '../../components/sections/FullScreenHero.astro';
import heroImage from '../../assets/images/wethepeople.jpg';

export async function getStaticPaths() {
    const docsEntries = await getCollection('docs');
    return docsEntries.map((entry) => ({
        params: { slug: entry.id },
        props: { entry },
    }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);

// Use SEO data from frontmatter if available, fallback to regular entry data
const seoTitle = entry.data.seo?.title || entry.data.title;
const seoDescription = entry.data.seo?.description || '';

// Format the last updated date
const formattedDate = new Intl.DateTimeFormat('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    timeZone: 'UTC'
}).format(entry.data.lastUpdated);

// Hero content
const heroContent = {
    title: entry.data.title,
    description: entry.data.seo?.description || '',
    overlayOpacity: 0.8,
    backgroundImage: heroImage,
    contentPosition: 'center',
    textAlign: 'center'
};
---

<Layout title={seoTitle} description={seoDescription} fullscreenHero={true}>
    <FullScreenHero content={heroContent} />

    <article class="site-container--small mx-auto px-8 prose pb-base">
        <!-- Top navigation link -->
        <div class="mt-4 mb-6">
            <div class="flex justify-between items-baseline mb-4">
                <a href="/docs" class="inline-flex items-center text-sm text-accent hover:text-accent-dark transition-colors">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                    All Documents
                </a>
                <span class="text-sm text-body-base/80">Last updated: {formattedDate}</span>
            </div>
        </div>

        <Content />

        <!-- Bottom navigation link -->
        <div class="mt-12 pt-8 border-t border-body-base/10">
            <a href="/docs" class="inline-flex items-center text-sm text-accent hover:text-accent-dark transition-colors">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                All Documents
            </a>
        </div>
    </article>
</Layout> 